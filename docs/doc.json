{
    "schemes": [],
    "swagger": "2.0",
    "info": {
        "description": "HTTP API for Vulnerability Intelligence Data",
        "title": "Vulnerability Intelligence Backend API",
        "contact": {},
        "license": {
            "name": "AGPL-3.0-or-later"
        },
        "version": "0.9"
    },
    "host": "opensight-dev2.greenbone.io",
    "basePath": "/",
    "paths": {
        "/cpes/search": {
            "post": {
                "description": "Retrieve all CPE data that matches a search given in OpenSearch's query DSL.\nThe response example is a simplified version of the actual responses.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "summary": "Retrieve CPE data using OpenSearch query DSL",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "description": "OpenSearch Query DSL",
                        "name": "search",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/web.OpenSearchQuery"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "query": {
                                            "$ref": "#/definitions/web.TermQueryCPE"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/web.OpenSearchResult"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "hits": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/definitions/models.CPEProduct"
                                            }
                                        }
                                    }
                                }
                            ]
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        },
        "/cpes/{cpe}": {
            "get": {
                "description": "Returns the full CPE JSON object given a CPE ID",
                "produces": [
                    "application/json"
                ],
                "summary": "Get CPE data for a specific CPE",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "type": "string",
                        "x-example": "cpe:2.3:a:3com:3cdaemon:-:*:*:*:*:*:*:*",
                        "description": "cpe",
                        "name": "cpe",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        },
        "/csafs/search": {
            "post": {
                "description": "Retrieve all CSAF data that matches a search given in OpenSearch's query DSL.\nThe response example is a simplified version of the actual responses.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "summary": "Retrieve CSAF data using OpenSearch query DSL",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "description": "OpenSearch Query DSL",
                        "name": "search",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/web.OpenSearchQuery"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "query": {
                                            "$ref": "#/definitions/web.TermQueryCSAF"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/web.OpenSearchResult"
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        },
        "/csafs/{csaf}": {
            "get": {
                "description": "Returns the full CSAF JSON object given a CPE ID",
                "produces": [
                    "application/json"
                ],
                "summary": "Get CSAF data",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "type": "string",
                        "x-example": "wid-sec-w-2023-0069",
                        "description": "csaf",
                        "name": "csaf",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        },
        "/cves/search": {
            "post": {
                "description": "Retrieve all CVE data that matches a search given in OpenSearch's query DSL.\n\nThe response example is a simplified version of the actual responses.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "summary": "Retrieve CVE data using OpenSearch query DSL",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "description": "OpenSearch Query DSL",
                        "name": "search",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/web.OpenSearchQuery"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "query": {
                                            "$ref": "#/definitions/web.TermQueryCVE"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/web.OpenSearchResult"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "hits": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "additionalProperties": {
                                                    "type": "string"
                                                }
                                            }
                                        }
                                    }
                                }
                            ]
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        },
        "/cves/{cve}": {
            "get": {
                "description": "Returns the full CVE JSON object given a CVE number",
                "produces": [
                    "application/json"
                ],
                "summary": "Get CVE data for a specific CVE number",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "type": "string",
                        "x-example": "CVE-2021-44228",
                        "description": "CVE",
                        "name": "cve",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        },
        "/kevs/search": {
            "post": {
                "description": "Retrieve all KEV data that matches a search given in OpenSearch's query DSL.\n\nThe response example is a simplified version of the actual responses.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "summary": "Retrieve KEV data using OpenSearch query DSL",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "description": "OpenSearch Query DSL",
                        "name": "search",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/web.OpenSearchQuery"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "query": {
                                            "$ref": "#/definitions/web.TermQueryKEV"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/web.OpenSearchResult"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "hits": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/definitions/models.KEVVulnerability"
                                            }
                                        }
                                    }
                                }
                            ]
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        },
        "/kevs/{cve}": {
            "get": {
                "description": "Returns the full KEV JSON object given a CVE number",
                "produces": [
                    "application/json"
                ],
                "summary": "Get KEV data for a specific CVE number",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "type": "string",
                        "x-example": "CVE-2021-44228",
                        "description": "cve",
                        "name": "cve",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "object"
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        },
        "/search": {
            "post": {
                "description": "Searches for any data available in the backend using OpenSearch's query DSL.\n\nThe response example is a simplified version of the actual responses.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "summary": "Search across all types of data using OpenSearch query DSL",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "description": "OpenSearch Query DSL",
                        "name": "search",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/web.OpenSearchQuery"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "query": {
                                            "$ref": "#/definitions/web.MultimatchQueryGlobal"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/web.OpenSearchResult"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "hits": {
                                            "type": "array",
                                            "items": {
                                                "type": "object",
                                                "additionalProperties": {
                                                    "type": "string"
                                                }
                                            }
                                        }
                                    }
                                }
                            ]
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        },
        "/sql": {
            "post": {
                "description": "Searches for any data available in the backend using OpenSearch's SQL dialect.\n\nThe response example is a simplified version of the actual responses.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "summary": "Search across all types of data using SQL",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "description": "SQL query",
                        "name": "search",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/web.SQLQuery"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/web.SQLResult"
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        },
        "/vts/search": {
            "post": {
                "description": "Retrieve all VT meta data that matches a search given in OpenSearch's query DSL.\n\nThe response example is a simplified version of the actual responses.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "summary": "Retrieve VT meta data using OpenSearch query DSL",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "description": "OpenSearch Query DSL",
                        "name": "search",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/web.OpenSearchQuery"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "query": {
                                            "$ref": "#/definitions/web.TermQueryVT"
                                        }
                                    }
                                }
                            ]
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "allOf": [
                                {
                                    "$ref": "#/definitions/web.OpenSearchResult"
                                },
                                {
                                    "type": "object",
                                    "properties": {
                                        "hits": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/definitions/models.Meta"
                                            }
                                        }
                                    }
                                }
                            ]
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        },
        "/vts/{oid}": {
            "get": {
                "description": "Get VT meta data for a specific OID",
                "produces": [
                    "application/json"
                ],
                "summary": "Get VT meta data for a specific OID",
                "parameters": [
                    {
                        "type": "string",
                        "example": "Bearer eyJhbGciOiJSUzI1NiIs",
                        "description": "Authentication header",
                        "name": "Authorization",
                        "in": "header",
                        "required": true
                    },
                    {
                        "type": "string",
                        "x-example": "1.3.6.1.4.1.25623.1.0.113858",
                        "description": "OID",
                        "name": "oid",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/models.Meta"
                        },
                        "headers": {
                            "api-version": {
                                "type": "string",
                                "description": "API version"
                            }
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "models.CPEAttributes": {
            "type": "object",
            "properties": {
                "cpeName": {
                    "type": "string"
                },
                "cpeNameId": {
                    "type": "string"
                }
            }
        },
        "models.CPEProduct": {
            "type": "object",
            "properties": {
                "cpeName": {
                    "type": "string"
                },
                "cpeNameId": {
                    "type": "string"
                },
                "created": {
                    "type": "string"
                },
                "deprecated": {
                    "type": "boolean"
                },
                "deprecatedBy": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/models.CPEAttributes"
                    }
                },
                "deprecates": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/models.CPEAttributes"
                    }
                },
                "lastModified": {
                    "type": "string"
                },
                "refs": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/models.CPERef"
                    }
                },
                "titles": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/models.CPETitle"
                    }
                }
            }
        },
        "models.CPERef": {
            "type": "object",
            "properties": {
                "ref": {
                    "type": "string"
                },
                "type": {
                    "type": "string"
                }
            }
        },
        "models.CPETitle": {
            "type": "object",
            "properties": {
                "lang": {
                    "type": "string"
                },
                "title": {
                    "type": "string"
                }
            }
        },
        "models.Format": {
            "type": "string",
            "enum": [
                "NASL",
                "NOTUS"
            ],
            "x-enum-varnames": [
                "NASLFormat",
                "NOTUSFormat"
            ]
        },
        "models.KEVVulnerability": {
            "type": "object",
            "properties": {
                "cveID": {
                    "type": "string"
                },
                "dateAdded": {
                    "type": "string"
                },
                "dueDate": {
                    "type": "string"
                },
                "notes": {
                    "type": "string"
                },
                "product": {
                    "type": "string"
                },
                "requiredAction": {
                    "type": "string"
                },
                "shortDescription": {
                    "type": "string"
                },
                "vendorProject": {
                    "type": "string"
                },
                "vulnerabilityName": {
                    "type": "string"
                }
            }
        },
        "models.Meta": {
            "type": "object",
            "properties": {
                "AdvisoryXREF": {
                    "type": "string"
                },
                "Affected": {
                    "type": "string"
                },
                "Authentication": {
                    "type": "string"
                },
                "CVEs": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "Category": {
                    "type": "string"
                },
                "CreationDate": {
                    "type": "integer"
                },
                "Dependencies": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "Deprecated": {
                    "type": "boolean"
                },
                "DeprecationDate": {
                    "type": "integer"
                },
                "DetectionType": {
                    "type": "string"
                },
                "EnterpriseFeedOnly": {
                    "type": "boolean"
                },
                "ExcludedKeys": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "Family": {
                    "type": "string"
                },
                "Format": {
                    "$ref": "#/definitions/models.Format"
                },
                "Impact": {
                    "type": "string"
                },
                "Insight": {
                    "type": "string"
                },
                "LastModification": {
                    "type": "integer"
                },
                "MandatoryKeys": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "OID": {
                    "type": "string"
                },
                "Preferences": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/models.Preference"
                    }
                },
                "QoD": {
                    "type": "integer"
                },
                "QoDType": {
                    "type": "string"
                },
                "RequiredKeys": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "RequiredTCPPorts": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "RequiredUDPPorts": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "SeverityClass": {
                    "type": "string"
                },
                "SeverityDate": {
                    "type": "integer"
                },
                "SeverityOrigin": {
                    "type": "string"
                },
                "SeverityScore": {
                    "type": "number"
                },
                "SeverityVector": {
                    "type": "string"
                },
                "Solution": {
                    "type": "string"
                },
                "SolutionMethod": {
                    "type": "string"
                },
                "SolutionType": {
                    "type": "string"
                },
                "Summary": {
                    "type": "string"
                },
                "Timeout": {
                    "type": "integer"
                },
                "Title": {
                    "type": "string"
                },
                "VulDetect": {
                    "type": "string"
                },
                "XREFs": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        },
        "models.Preference": {
            "type": "object",
            "properties": {
                "class": {
                    "type": "string"
                },
                "default": {
                    "type": "string"
                },
                "id": {
                    "type": "integer"
                },
                "name": {
                    "type": "string"
                }
            }
        },
        "web.MultimatchQueryGlobal": {
            "type": "object",
            "properties": {
                "multi_match": {
                    "type": "object",
                    "properties": {
                        "fields": {
                            "type": "array",
                            "items": {
                                "type": "string"
                            },
                            "example": [
                                "_id",
                                "CVEs"
                            ]
                        },
                        "query": {
                            "type": "string",
                            "example": "CVE-2020-4126"
                        }
                    }
                }
            }
        },
        "web.OpenSearchQuery": {
            "type": "object",
            "properties": {
                "query": {}
            }
        },
        "web.OpenSearchResult": {
            "type": "object",
            "properties": {
                "hits": {}
            }
        },
        "web.SQLQuery": {
            "type": "object",
            "properties": {
                "query": {
                    "type": "string",
                    "example": "SELECT distinct Family FROM vts"
                }
            }
        },
        "web.SQLResult": {
            "type": "object",
            "properties": {
                "dataRows": {
                    "type": "array",
                    "items": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                },
                "schema": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/web.SchemaItem"
                    }
                }
            }
        },
        "web.SchemaItem": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string",
                    "example": "Family"
                },
                "type": {
                    "type": "string",
                    "example": "keyword"
                }
            }
        },
        "web.TermQueryCPE": {
            "type": "object",
            "properties": {
                "term": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "string"
                    },
                    "example": {
                        "cpeNameId": "BAE41D20-D4AF-4AF0-AA7D-3BD04DA402A7"
                    }
                }
            }
        },
        "web.TermQueryCSAF": {
            "type": "object",
            "properties": {
                "term": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "string"
                    },
                    "example": {
                        "document.category": "csaf_base"
                    }
                }
            }
        },
        "web.TermQueryCVE": {
            "type": "object",
            "properties": {
                "term": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "string"
                    },
                    "example": {
                        "containers.cna.problemTypes.descriptions.cweId": "CWE-502"
                    }
                }
            }
        },
        "web.TermQueryKEV": {
            "type": "object",
            "properties": {
                "term": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "string"
                    },
                    "example": {
                        "cveID": "CVE-2021-44228"
                    }
                }
            }
        },
        "web.TermQueryVT": {
            "type": "object",
            "properties": {
                "term": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "string"
                    },
                    "example": {
                        "CVEs": "CVE-2021-44228"
                    }
                }
            }
        }
    },
    "externalDocs": {
        "description": "OpenAPI",
        "url": "https://swagger.io/resources/open-api/"
    }
}
